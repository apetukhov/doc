<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
      <title>Migrating to 1.1 | Npgsql Documentation </title>
      <meta name="viewport" content="width=device-width, initial-scale=1.0">
      <meta name="title" content="Migrating to 1.1 | Npgsql Documentation ">
      
      
      <link rel="icon" href="../../favicon.ico">
      <link rel="stylesheet" href="../../public/docfx.min.css">
      <link rel="stylesheet" href="../../public/main.css">
      <meta name="docfx:navrel" content="../../toc.html">
      <meta name="docfx:tocrel" content="../toc.html">
      
      <meta name="docfx:rel" content="../../">
      
      
      <meta name="docfx:docurl" content="https://github.com/npgsql/doc/blob/main/conceptual/EFCore.PG/release-notes/1.1.md/#L1">
      <meta name="loc:inThisArticle" content="In this article">
      <meta name="loc:searchResultsCount" content="{count} results for &quot;{query}&quot;">
      <meta name="loc:searchNoResults" content="No results for &quot;{query}&quot;">
      <meta name="loc:tocFilter" content="Filter by title">
      <meta name="loc:nextArticle" content="Next">
      <meta name="loc:prevArticle" content="Previous">
      <meta name="loc:themeLight" content="Light">
      <meta name="loc:themeDark" content="Dark">
      <meta name="loc:themeAuto" content="Auto">
      <meta name="loc:changeTheme" content="Change theme">
      <meta name="loc:copy" content="Copy">
      <meta name="loc:downloadPdf" content="Download PDF">

      <script type="module" src="./../../public/docfx.min.js"></script>

      <script>
        const theme = localStorage.getItem('theme') || 'auto'
        document.documentElement.setAttribute('data-bs-theme', theme === 'auto' ? (window.matchMedia('(prefers-color-scheme: dark)').matches ? 'dark' : 'light') : theme)
      </script>

  </head>

  <body class="tex2jax_ignore" data-layout="" data-yaml-mime="">
    <header class="bg-body border-bottom">
      <nav id="autocollapse" class="navbar navbar-expand-md" role="navigation">
        <div class="container-xxl flex-nowrap">
          <a class="navbar-brand" href="../../index.html">
            <img id="logo" class="svg" src="../../img/logo.svg" alt="">
            
          </a>
          <button class="btn btn-lg d-md-none border-0" type="button" data-bs-toggle="collapse" data-bs-target="#navpanel" aria-controls="navpanel" aria-expanded="false" aria-label="Toggle navigation">
            <i class="bi bi-three-dots"></i>
          </button>
          <div class="collapse navbar-collapse" id="navpanel">
            <div id="navbar">
              <form class="search" role="search" id="search">
                <i class="bi bi-search"></i>
                <input class="form-control" id="search-query" type="search" disabled="" placeholder="Search" autocomplete="off" aria-label="Search">
              </form>
            </div>
          </div>
        </div>
      </nav>
    </header>

    <main class="container-xxl">
      <div class="toc-offcanvas">
        <div class="offcanvas-md offcanvas-start" tabindex="-1" id="tocOffcanvas" aria-labelledby="tocOffcanvasLabel">
          <div class="offcanvas-header">
            <h5 class="offcanvas-title" id="tocOffcanvasLabel">Table of Contents</h5>
            <button type="button" class="btn-close" data-bs-dismiss="offcanvas" data-bs-target="#tocOffcanvas" aria-label="Close"></button>
          </div>
          <div class="offcanvas-body">
            <nav class="toc" id="toc"></nav>
          </div>
        </div>
      </div>

      <div class="content">
        <div class="actionbar">
          <button class="btn btn-lg border-0 d-md-none" type="button" data-bs-toggle="offcanvas" data-bs-target="#tocOffcanvas" aria-controls="tocOffcanvas" aria-expanded="false" aria-label="Show table of contents">
            <i class="bi bi-list"></i>
          </button>

          <nav id="breadcrumb"></nav>
        </div>

        <article data-uid="">
<h1 id="migrating-to-11">Migrating to 1.1</h1>

<p>Version 1.1.0 of the Npgsql Entity Framework Core provider has been released and is available on nuget. This version works with <a href="https://blogs.msdn.microsoft.com/dotnet/2016/10/25/announcing-entity-framework-core-1-1-preview-1/">version 1.1.0 of Entity Framework Core</a>, and contains some new Npgsql features as well. Note that if you're using the command-line tools, you'll have to modify your tools section as described in the EF Core release post:</p>
<pre><code class="lang-json">&quot;tools&quot;: {
  &quot;Microsoft.EntityFrameworkCore.Tools.DotNet&quot;: &quot;1.0.0-preview3-final&quot;
},
</code></pre>
<h2 id="new-features">New Features</h2>
<p>Aside from general EF Core features, version 1.1.0 of the Npgsql provider contains the following:</p>
<ul>
<li>Hilo key generation (<a href="https://github.com/npgsql/Npgsql.EntityFrameworkCore.PostgreSQL/issues/5">#5</a>). This can be a much more efficient way to generate autoincrement key values.</li>
<li>PostgreSQL array mapping (<a href="https://github.com/npgsql/Npgsql.EntityFrameworkCore.PostgreSQL/issues/15">#15</a>). This allows you to have plain CLR arrays on your entities, and have those arrays mapped to native <a href="https://www.postgresql.org/docs/current/static/arrays.html">PostgreSQL array columns</a>.</li>
<li>Optimistic concurrency with PostgreSQL's xmin column (<a href="https://github.com/npgsql/Npgsql.EntityFrameworkCore.PostgreSQL/issues/19">#19</a>). Simply specify <code>.UseXminAsConcurrencyToken()</code> on an entity to start using this, see the <a href="https://docs.efproject.net/en/latest/modeling/concurrency.html">EF docs for more details</a>.</li>
<li>Cleanup of how serial (autoincrement) and generated GUID/UUID columns are managed.</li>
</ul>
<p>Here's the <a href="https://github.com/npgsql/Npgsql.EntityFrameworkCore.PostgreSQL/milestone/3?closed=1">full list of issues</a>. Please report any problems to <a href="https://github.com/npgsql/Npgsql.EntityFrameworkCore.PostgreSQL">https://github.com/npgsql/Npgsql.EntityFrameworkCore.PostgreSQL</a>.</p>
<h2 id="upgrading-from-10x">Upgrading from 1.0.x</h2>
<p>If you've used 1.0.x without migrations, you can simply upgrade and everything should just work. Unfortunately, if you already have migrations from 1.0.x you'll have to do some manual fixups because of some bad decisions that were previously made. If deleting your old migrations and starting over (e.g. non-production database) is an option, you may wish to do so. The following are instructions for fixing up 1.0.x migrations.</p>
<p>First, Npgsql 1.0.x used a problematic method to identify serial (autoincrement) columns in migrations. If you look at your migration code you'll see <code>.Annotation(&quot;Npgsql:ValueGeneratedOnAdd&quot;, true)</code> on various columns. Unfortunately this annotation is also present on non-serial columns, e.g. columns with default values. This causes various issues and has been replaced in 1.1. However, you'll have to manually remove <code>.Annotation(&quot;Npgsql:ValueGeneratedOnAdd&quot;, true)</code>, and replace it with <code>.Annotation(&quot;Npgsql:ValueGenerationStrategy&quot;, NpgsqlValueGenerationStrategy.SerialColumn)</code> but <em>only</em> on columns which should be serial (e.g. not on columns with defaults). If you attempt to run a migration that has the old annotation, Npgsql will throw an exception and refuse to run your migrations.</p>
<p>Unfortunately, this change will cause some incorrect changes the first time you add a migration after the upgrade. To avoid this, simply add a dummy migration right after upgrading to 1.1 and then delete the two new files generated for the dummy migration, <em>but keep the changes made to your ModelSnapshot.cs</em>. From this point on everything should be fine. <em>Make sure you have no pending changes to your model before doing this!</em>.</p>
<p>Apologies for this problematic upgrade procedure, it should at least keep things clean going forward.</p>
<h2 id="contributors">Contributors</h2>
<p>Thank you very much to the following people who have contributed to the individual 1.1.x. releases.</p>
<h3 id="milestone-111"><a href="https://github.com/npgsql/EFCore.PG/issues?q=is%3Aissue+milestone%3A1.1.1">Milestone 1.1.1</a></h3>
<table>
<thead>
<tr>
<th>Contributor</th>
<th style="text-align: right;">Assigned issues</th>
</tr>
</thead>
<tbody>
<tr>
<td><a href="https://github.com/roji">@roji</a></td>
<td style="text-align: right;"><a href="https://github.com/npgsql/EFCore.PG/issues?q=is%3Aissue+milestone%3A1.1.1+is%3Aclosed+assignee%3Aroji">8</a></td>
</tr>
</tbody>
</table>
<h3 id="milestone-110"><a href="https://github.com/npgsql/EFCore.PG/issues?q=is%3Aissue+milestone%3A1.1.0">Milestone 1.1.0</a></h3>
<table>
<thead>
<tr>
<th>Contributor</th>
<th style="text-align: right;">Assigned issues</th>
</tr>
</thead>
<tbody>
<tr>
<td><a href="https://github.com/roji">@roji</a></td>
<td style="text-align: right;"><a href="https://github.com/npgsql/EFCore.PG/issues?q=is%3Aissue+milestone%3A1.1.0+is%3Aclosed+assignee%3Aroji">11</a></td>
</tr>
</tbody>
</table>

</article>

        <div class="contribution d-print-none">
          <a href="https://github.com/npgsql/doc/blob/main/conceptual/EFCore.PG/release-notes/1.1.md/#L1" class="edit-link">Edit this page</a>
        </div>

        <div class="next-article d-print-none border-top" id="nextArticle"></div>

      </div>

      <div class="affix">
        <nav id="affix"></nav>
      </div>
    </main>

    <div class="container-xxl search-results" id="search-results"></div>

    <footer class="border-top text-secondary">
      <div class="container-xxl">
        <div class="flex-fill">
          © Copyright 2024 The Npgsql Development Team
        </div>
      </div>
    </footer>
  </body>
</html>
