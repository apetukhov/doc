<!DOCTYPE html>
<!--[if IE]><![endif]-->
<html>

  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <title> | Npgsql Documentation </title>
    <meta name="viewport" content="width=device-width">
    <meta name="title" content=" | Npgsql Documentation ">
  
    <link rel="apple-touch-icon" sizes="180x180" href="../../../../apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="../../../../favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="../../../../favicon-16x16.png">
    <link rel="manifest" href="../../../../site.webmanifest">
    <link rel="mask-icon" href="../../../../safari-pinned-tab.svg" color="#5bbad5">
    <meta name="msapplication-TileColor" content="#2b5797">
    <meta name="theme-color" content="#ffffff">
    <link rel="stylesheet" href="../../../../styles/docfx.vendor.css">
    <link rel="stylesheet" href="../../../../styles/docfx.css">
    <link rel="stylesheet" href="../../../../styles/main.css">
    <link rel="stylesheet" href="../../../../styles/npgsql.css">
    <meta property="docfx:navrel" content="">
    <meta property="docfx:tocrel" content="">
  
  <meta property="docfx:rel" content="../../../../">
  
  </head>
  <body data-spy="scroll" data-target="#affix" data-offset="120">
    <div id="wrapper">
      <header>

        <nav id="autocollapse" class="navbar navbar-inverse ng-scope" role="navigation">
          <div class="container">
            <div class="navbar-header">
              <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#navbar">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
              </button>

              <a class="navbar-brand" href="../../../../index.html">
                <img id="logo" class="svg" src="../../../../logo.svg" alt="">
              </a>
            </div>
            <div class="collapse navbar-collapse" id="navbar">
              <form class="navbar-form navbar-right" role="search" id="search">
                <div class="form-group">
                  <input type="text" class="form-control" id="search-query" placeholder="Search" autocomplete="off">
                </div>
              </form>
            </div>
          </div>
        </nav>

        <div class="subnav navbar navbar-default">
          <div class="container hide-when-search" id="breadcrumb">
            <ul class="breadcrumb">
              <li></li>
            </ul>
          </div>
        </div>
      </header>
      <div class="container body-content">

        <div id="search-results">
          <div class="search-list">Search Results for <span></span></div>
          <div class="sr-items">
            <p><i class="glyphicon glyphicon-refresh index-loading"></i></p>
          </div>
          <ul id="pagination" data-first="First" data-prev="Previous" data-next="Next" data-last="Last"></ul>
        </div>
      </div>
      <div role="main" class="container body-content hide-when-search">
        <div class="article row grid">
          <div class="col-md-10">
            <article class="content wrap" id="_content" data-uid="">

<p>Npgsql is the open source .NET data provider for PostgreSQL. It allows you to connect and interact with PostgreSQL server using .NET.</p>
<p>This package helps set up Npgsql in applications using dependency injection, notably ASP.NET applications. It allows easy configuration of your Npgsql connections and registers the appropriate services in your DI container.</p>
<p>For example, if using the ASP.NET minimal web API, simply use the following to register Npgsql:</p>
<pre><code class="lang-csharp">var builder = WebApplication.CreateBuilder(args);

builder.Services.AddNpgsqlDataSource(&quot;Host=pg_server;Username=test;Password=test;Database=test&quot;);
</code></pre>
<p>This registers a transient <a href="https://www.npgsql.org/doc/api/Npgsql.NpgsqlConnection.html"><code>NpgsqlConnection</code></a> which can get injected into your controllers:</p>
<pre><code class="lang-csharp">app.MapGet(&quot;/&quot;, async (NpgsqlConnection connection) =&gt;
{
    await connection.OpenAsync();
    await using var command = new NpgsqlCommand(&quot;SELECT number FROM data LIMIT 1&quot;, connection);
    return &quot;Hello World: &quot; + await command.ExecuteScalarAsync();
});
</code></pre>
<p>But wait! If all you want is to execute some simple SQL, just use the singleton <a href="https://www.npgsql.org/doc/api/Npgsql.NpgsqlDataSource.html"><code>NpgsqlDataSource</code></a> to execute a command directly:</p>
<pre><code class="lang-csharp">app.MapGet(&quot;/&quot;, async (NpgsqlDataSource dataSource) =&gt;
{
    await using var command = dataSource.CreateCommand(&quot;SELECT number FROM data LIMIT 1&quot;);
    return &quot;Hello World: &quot; + await command.ExecuteScalarAsync();
});
</code></pre>
<p><a href="https://www.npgsql.org/doc/api/Npgsql.NpgsqlDataSource.html"><code>NpgsqlDataSource</code></a> can also come in handy when you need more than one connection:</p>
<pre><code class="lang-csharp">app.MapGet(&quot;/&quot;, async (NpgsqlDataSource dataSource) =&gt;
{
    await using var connection1 = await dataSource.OpenConnectionAsync();
    await using var connection2 = await dataSource.OpenConnectionAsync();
    // Use the two connections...
});
</code></pre>
<p>Finally, the <code>AddNpgsqlDataSource</code> method also accepts a lambda parameter allowing you to configure aspects of Npgsql beyond the connection string, e.g. to configure <code>UseLoggerFactory</code> and <code>UseNetTopologySuite</code>:</p>
<pre><code class="lang-csharp">var builder = WebApplication.CreateBuilder(args);

builder.Services.AddNpgsqlDataSource(
    &quot;Host=pg_server;Username=test;Password=test;Database=test&quot;,
    builder =&gt; builder
        .UseLoggerFactory(loggerFactory)
        .UseNetTopologySuite());
</code></pre>
<p>For more information, <a href="https://www.npgsql.org/doc/index.html">see the Npgsql documentation</a>.</p>

</article>
          </div>

          <div class="hidden-sm col-md-2" role="complementary">
            <div class="sideaffix">
              <div class="contribution">
                <ul class="nav">
                  <li>
                    <a href="https://github.com/npgsql/npgsql/blob/main/src/Npgsql.DependencyInjection/README.md/#L1" class="contribution-link">Edit this page</a>
                  </li>
                </ul>
              </div>
              <nav class="bs-docs-sidebar hidden-print hidden-xs hidden-sm affix" id="affix">
                <h5>In this article</h5>
                <div></div>
              </nav>
            </div>
          </div>
        </div>
      </div>

      <footer>
        <div class="grad-bottom"></div>
        <div class="footer">
          <div class="container">
            <span class="pull-right">
              <a href="#top">Back to top</a>
            </span>
      © Copyright 2024 The Npgsql Development Team
      
          </div>
        </div>
      </footer>
    </div>

    <script type="text/javascript" src="../../../../styles/docfx.vendor.min.js"></script>
    <script type="text/javascript" src="../../../../styles/docfx.js"></script>
    <script type="text/javascript" src="../../../../styles/main.js"></script>
  </body>
</html>
